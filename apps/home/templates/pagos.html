{% extends 'menu.html' %}
{% block contenido %}
<div class="container">
    <div class="contenido table-responsive-lg espacio">
        <h1 class="title-container">
            Listado de Pagos
        </h1>
        <div class="outer-wrapper">
            <div class="contenido-tabla table-wrapper">
                <table class="table-fill">
                    <thead>
                        <tr>
                            <th>
                                No Recibo
                            </th>
                            <th>
                                Fecha
                            </th>
                            <th>
                                Mes Pagado
                            </th>
                            <th>
                                Código contratacion
                            </th>
                            <th>
                                Total
                            </th>
                        </tr>
                    </thead>
                    <tbody class="fontfamily">
                        {% for pago in pagos %}
                        <tr>
                            <td class="text-center">
                                {{pago.recibo.id}}
                            </td>
                            <td class="text-center">
                                {{pago.creacion}}
                            </td>
                            <td class="text-center">
                                {{pago.mes}}/{{pago.anio}}
                            </td>
                            <td class="text-center">
                                {{pago.recibo.contratacion.id}}
                            </td>
                            <td class="text-center">
                                {{pago.subtotal}}
                            </td>
                            <td class="text-center">
                                <a href="#"><i class="bi bi-trash"></i></a>
                                <a href="#"><i class="bi bi-journal-text"></i></a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>          
</div>   

<form action="{% url 'home:nuevorecibo' %}" method="post">
    {% csrf_token %}
    <label for="contratacion">¿Qué servicio desea pagar?</label>
    <input list="listacontrataciones" name="contratacion" required>
    <datalist id="listacontrataciones">
        {% for contratacion in contrataciones %}
        <option value="{{contratacion.id}}">{{contratacion.cliente.nombre}} {{contratacion.servicio.tipo}} {{contratacion.servicio.nombre}} </option>
        {% endfor %}
    </datalist>
    <button type="submit">Nuevo pago</button>
</form>
<table>
    <tr>
        <td>No Recibo</td>
        <td>Fecha</td>
        <td>Código</td>
        <td>Cliente</td>
        <td>Mes Pagado</td>
        <td>Total</td>
    </tr>
    {% for pago in pagos %}
    <tr>
        <td> {{pago.id}} </td>
        <td> {{pago.fecha.date}} </td>
        <td> {{pago.contratacion.id}}</td>
        <td> {{pago.contratacion.cliente }}, {{pago.contratacion.direccion }} </td>
        <td>
            {% for mesanio in pago.detallepago_set.all %}
            {{mesanio.mes}},
            {% endfor %}
        </td>
        <td> {{pago.total}} </td>
    </tr>
    {% endfor %}
</table>
{% endblock contenido %}